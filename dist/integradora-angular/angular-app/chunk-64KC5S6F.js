import{a as A,b as Q}from"./chunk-2SW5W63J.js";import{a as L}from"./chunk-ES5VQ5UD.js";import{a as U}from"./chunk-4LWGM43U.js";import{a as z,b as h,c as N,d as q,e as D,f as H,g as O,h as j,i as B,j as R,k as G,l as $,m as Z}from"./chunk-JCGB7RHH.js";import"./chunk-B56ZGRNC.js";import{b as x,d as T,e as k,k as M}from"./chunk-NGLC2CXL.js";import{Ga as _,Ia as u,Ka as V,La as a,Ma as n,Na as m,Qa as P,Ra as v,Sa as g,Xa as l,Y as E,Ya as I,Za as p,_a as c,ab as C,cb as F,d as K,ea as f,fa as w,ra as y,ua as i,va as S}from"./chunk-SYTZFNVP.js";var J=K(Q());var W=(o,d)=>({"text-success":o,"text-danger":d}),X=(o,d)=>({"btn-danger":o,"btn-success":d});function Y(o,d){if(o&1&&(a(0,"div",28),l(1),n()),o&2){let t=g();i(),p(" ",t.msg,`
`)}}function tt(o,d){if(o&1){let t=P();a(0,"button",29),v("click",function(){f(t);let s=g();return w(s.openModal(s.plantShow==null||s.plantShow.data==null?null:s.plantShow.data.id))}),l(1,"Desactivar"),n()}}function et(o,d){if(o&1){let t=P();a(0,"button",30),v("click",function(){f(t);let s=g();return w(s.openModal(s.plantShow==null||s.plantShow.data==null?null:s.plantShow.data.id))}),l(1,"Activar"),n()}}function at(o,d){if(o&1&&(a(0,"div",1)(1,"div",31)(2,"div",32)(3,"div",4)(4,"div",33),m(5,"img",34),a(6,"h5",7),l(7,"Agua"),n(),a(8,"p",35),l(9),n(),a(10,"p",35),l(11),n()()()(),a(12,"div",32)(13,"div",4)(14,"div",33),m(15,"img",36),a(16,"h5",7),l(17,"Temperatura"),n(),a(18,"p",35),l(19),n(),a(20,"p",35),l(21),n()()()(),a(22,"div",32)(23,"div",4)(24,"div",33),m(25,"img",37),a(26,"h5",7),l(27,"Humedad"),n(),a(28,"p",35),l(29),n(),a(30,"p",35),l(31),n()()()(),a(32,"div",32)(33,"div",4)(34,"div",33),m(35,"img",38),a(36,"h5",7),l(37,"Lluvia"),n(),a(38,"p",35),l(39),n(),a(40,"p",35),l(41),n()()()(),a(42,"div",32)(43,"div",4)(44,"div",33),m(45,"img",39),a(46,"h5",7),l(47,"Suelo"),n(),a(48,"p",35),l(49),n(),a(50,"p",35),l(51),n()()()(),a(52,"div",32)(53,"div",4)(54,"div",33),m(55,"img",40),a(56,"h5",7),l(57,"Luz"),n(),a(58,"p",35),l(59),n(),a(60,"p",35),l(61),n()()()(),a(62,"div",32)(63,"div",4)(64,"div",33),m(65,"img",41),a(66,"h5",7),l(67,"Movimiento"),n(),a(68,"p",35),l(69),n(),a(70,"p",35),l(71),n()()()(),a(72,"div",32)(73,"div",4)(74,"div",33),m(75,"img",42),a(76,"h5",7),l(77,"Vibracion"),n(),a(78,"p",35),l(79),n(),a(80,"p",35),l(81),n()()()()()()),o&2){let t=g();i(9),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Agua==null?null:t.data_sensor.data.Agua.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Agua==null?null:t.data_sensor.data.Agua.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Agua==null?null:t.data_sensor.data.Agua.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Lluvia==null?null:t.data_sensor.data.Lluvia.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Lluvia==null?null:t.data_sensor.data.Lluvia.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Lluvia==null?null:t.data_sensor.data.Lluvia.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Suelo==null?null:t.data_sensor.data.Suelo.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Suelo==null?null:t.data_sensor.data.Suelo.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Suelo==null?null:t.data_sensor.data.Suelo.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Luz==null?null:t.data_sensor.data.Luz.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Luz==null?null:t.data_sensor.data.Luz.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Luz==null?null:t.data_sensor.data.Luz.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Movimiento==null?null:t.data_sensor.data.Movimiento.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Movimiento==null?null:t.data_sensor.data.Movimiento.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Movimiento==null?null:t.data_sensor.data.Movimiento.Fecha,""),i(8),c("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Vibracion==null?null:t.data_sensor.data.Vibracion.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Vibracion==null?null:t.data_sensor.data.Vibracion.Unidad,""),i(2),p("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Vibracion==null?null:t.data_sensor.data.Vibracion.Fecha,"")}}function nt(o,d){o&1&&(a(0,"div"),l(1,"Planta es requerida"),n())}function lt(o,d){if(o&1&&(a(0,"div",43),_(1,nt,2,0,"div",44),n()),o&2){let t=g();i(),u("ngIf",t.putPlantForm.controls.plant==null||t.putPlantForm.controls.plant.errors==null?null:t.putPlantForm.controls.plant.errors.required)}}function it(o,d){o&1&&(a(0,"div"),l(1,"Status es requerido"),n())}function ot(o,d){if(o&1&&(a(0,"div",43),_(1,it,2,0,"div",44),n()),o&2){let t=g();i(),u("ngIf",t.putPlantForm.controls.status==null||t.putPlantForm.controls.status.errors==null?null:t.putPlantForm.controls.status.errors.required)}}var vt=(()=>{let d=class d{constructor(r,s,e){this.plantService=r,this.router=s,this.formBuilder=e,this.putPlant={plant:"",status:0},this.data_sensor={data:{_id:"",Temperatura:{Valor:0,Unidad:"",Fecha:""},Humedad:{Valor:0,Unidad:"",Fecha:""},Lluvia:{Valor:0,Unidad:"",Fecha:""},Suelo:{Valor:0,Unidad:"",Fecha:""},Agua:{Valor:0,Unidad:"",Fecha:""},Luz:{Valor:0,Unidad:"",Fecha:""},Movimiento:{Valor:0,Unidad:"",Fecha:""},Vibracion:{Valor:0,Unidad:"",Fecha:""},updated_at:"",created_at:""}},this.img="",this.msg="",this.buttonActive=!0,this.putPlantForm=this.formBuilder.group({plant:[this.putPlant.plant,[h.required,h.minLength(3),h.maxLength(50),h.pattern(/^[a-zA-Z0-9 ]+$/)]],status:[this.putPlant.status,[h.required,h.min(0),h.max(1)]]})}ngOnInit(){console.log(this.id),this.id&&this.plantService.getPlantsById(this.id).subscribe(r=>{console.log("response",r),this.plantShow=r,console.log("var",this.plantShow)},r=>{console.log(r)}),this.img=this.getImg(),this.websocket()}getImg(){return`../../../assets/imagenes/plantsIcons/${Math.floor(Math.random()*5)+1}.jpg`}openModal(r){this.id=parseInt(r)}editModal(r,s,e){this.id=parseInt(r),this.putPlant.plant=s,this.putPlant.status=e}deletePlant(r){this.plantService.eliminarPlants(r).subscribe(s=>{this.ngOnInit(),console.log(s.msg),this.msg=s.msg,setTimeout(()=>{this.msg=""},3e3)})}editPlant(r){this.putPlant=this.putPlantForm.value,this.plantService.actualizarPlants(this.putPlant,r).subscribe(s=>{console.log(s.msg),this.msg=s.msg,setTimeout(()=>{this.msg=""},3e3),this.ngOnInit()})}regar(){this.buttonActive=!1,setTimeout(()=>{this.buttonActive=!0},15e3)}websocket(){window.Pusher=J.default,this.echo=new A({broadcaster:"pusher",key:"lifePlants09123",cluster:"mt1",encrypted:!0,wsHost:window.location.hostname,wsPort:6001,disableStats:!0,forceTLS:!1}),this.echo.channel("dataSensors").listen(".MongoData",r=>{console.log("hola"),console.log(this.echo),console.log(r),this.data_sensor=r,console.log("PRUEBAAAA"),console.log(this.data_sensor)})}closewebsocket(){this.echo&&this.echo.disconnect()}ngOnDestroy(){this.closewebsocket()}};d.\u0275fac=function(s){return new(s||d)(S(L),S(M),S($))},d.\u0275cmp=E({type:d,selectors:[["app-plant"]],inputs:{id:"id"},standalone:!0,features:[C],decls:44,vars:26,consts:[["class","alert alert-success","role","alert",4,"ngIf"],[1,"container","mt-5"],[1,"d-flex","justify-content-center","align-items-center"],[1,"col-md-6"],[1,"card","border-primary","shadow"],[1,"card-body","text-center"],["alt","",1,"IconPlant","mx-auto","d-block",3,"src"],[1,"card-title","text-primary"],[3,"ngClass"],[1,"card-footer","text-center"],["type","button",1,"btn","add",3,"click","disabled"],["type","button","data-bs-toggle","modal","data-bs-target","#putPlant",1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-fill"],["class","btn btn-danger","type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",3,"click",4,"ngIf"],["class","btn btn-success","type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",3,"click",4,"ngIf"],[3,"modalId","modalTitle"],["type","button","data-bs-dismiss","modal",1,"btn",3,"click","ngClass"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","plant",1,"form-label"],["type","text","id","plant","formControlName","plant","name","plantPut","required","",1,"form-control"],["class","text-danger",4,"ngIf"],["for","status",1,"form-label"],["id","status","formControlName","status","name","status","required","",1,"form-control"],["value","1"],["value","0"],["type","submit","data-bs-dismiss","modal",1,"btn","add",3,"disabled"],["role","alert",1,"alert","alert-success"],["type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",1,"btn","btn-danger",3,"click"],["type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",1,"btn","btn-success",3,"click"],[1,"row","justify-content-center"],[1,"col-md-2","mb-4"],[1,"card-body","d-flex","flex-column","align-items-center"],["src","../../assets/imagenes/raindrops-310146_1280.png","alt","",1,"sensorIcon"],[1,"card-text"],["src","../../assets/imagenes/temp.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/hum.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/lluvia.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/suelo.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/luz.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/mov.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/vibr.png","alt","",1,"sensorIcon"],[1,"text-danger"],[4,"ngIf"]],template:function(s,e){s&1&&(_(0,Y,2,1,"div",0),a(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),m(6,"img",6),a(7,"h1",7),l(8),n(),a(9,"h2",8),l(10),n()(),a(11,"div",9)(12,"button",10),v("click",function(){return e.regar()}),l(13,"Regar"),n(),a(14,"button",11),v("click",function(){return e.editModal(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.id,e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.plant,e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)}),m(15,"i",12),n(),_(16,tt,2,0,"button",13)(17,et,2,0,"button",14),n()()()()(),_(18,at,82,24,"div",1),a(19,"app-modal",15)(20,"p"),l(21),n(),a(22,"button",16),v("click",function(){return e.deletePlant(e.id)}),l(23),n(),a(24,"button",17),l(25,"Cancelar"),n()(),a(26,"app-modal",15)(27,"form",18),v("ngSubmit",function(){return e.editPlant(e.id)}),a(28,"div",19)(29,"label",20),l(30,"Planta"),n(),m(31,"input",21),_(32,lt,2,1,"div",22),n(),a(33,"div",19)(34,"label",23),l(35,"Status"),n(),a(36,"select",24)(37,"option",25),l(38,"Activo"),n(),a(39,"option",26),l(40,"Inactivo"),n()(),_(41,ot,2,1,"div",22),n(),a(42,"button",27),l(43,"Editar"),n()()()),s&2&&(u("ngIf",e.msg),i(6),u("src",e.img,y),i(2),I(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.plant),i(),u("ngClass",F(20,W,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1)),i(),p(" ",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Activo":"Inactivo"," "),i(2),u("disabled",!e.buttonActive),i(4),u("ngIf",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1),i(),u("ngIf",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1),i(),V(18,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?18:-1),i(),u("modalId","deletePlant")("modalTitle",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Desactivar planta":"Activar planta"),i(2),p("\xBFEst\xE1s seguro de ",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"desactivar":"activar"," la planta?"),i(),u("ngClass",F(23,X,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1)),i(),I((e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Desactivar":"Activar"),i(3),u("modalId","putPlant")("modalTitle","Editar planta"),i(),u("formGroup",e.putPlantForm),i(5),u("ngIf",(e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.invalid)&&((e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.dirty)||(e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.touched))),i(9),u("ngIf",(e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.invalid)&&((e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.dirty)||(e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.touched))),i(),u("disabled",!e.putPlantForm.valid))},dependencies:[k,x,T,Z,D,B,R,z,j,N,q,G,H,O,U],styles:[".add[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.sensorIcon[_ngcontent-%COMP%]{width:140px;height:100px}.IconPlant[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover}"]});let o=d;return o})();export{vt as PlantComponent};
