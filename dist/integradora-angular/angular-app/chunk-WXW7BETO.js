import{a as A,b as W,c as L}from"./chunk-CBI3LC4I.js";import{a as N}from"./chunk-DT5ZQ35X.js";import{a as H}from"./chunk-4LWGM43U.js";import{c as M}from"./chunk-RHMV3US2.js";import{a as z,b as v,c as U,d as D,e as q,f as O,g as j,h as B,i as R,j as G,k as $,l as Z,m as J}from"./chunk-IPELWIB7.js";import{h as T,j as V,k}from"./chunk-LYJN6XNL.js";import{Ga as m,Ia as r,Ka as g,La as a,Ma as l,Na as c,Qa as x,Ra as h,Sa as p,Xa as i,Y as E,Ya as C,Za as _,_a as w,ab as F,cb as I,d as Q,ea as b,fa as P,ra as y,ua as o,va as S}from"./chunk-SYTZFNVP.js";var K=Q(W());var X=(n,d)=>({"text-success":n,"text-danger":d}),Y=(n,d)=>({"btn-danger":n,"btn-success":d});function tt(n,d){if(n&1&&(a(0,"div",29),i(1),l()),n&2){let t=p();o(),_(" ",t.msg,`
`)}}function et(n,d){if(n&1){let t=x();a(0,"button",30),h("click",function(){b(t);let u=p();return P(u.openModal(u.plantShow==null||u.plantShow.data==null?null:u.plantShow.data.id))}),i(1,"Desactivar"),l()}}function nt(n,d){if(n&1){let t=x();a(0,"button",31),h("click",function(){b(t);let u=p();return P(u.openModal(u.plantShow==null||u.plantShow.data==null?null:u.plantShow.data.id))}),i(1,"Activar"),l()}}function at(n,d){n&1&&(a(0,"p",37),i(1,"No hay agua"),l())}function lt(n,d){n&1&&(a(0,"p",37),i(1,"Poca agua"),l())}function it(n,d){n&1&&(a(0,"p",37),i(1,"Hay agua"),l())}function ot(n,d){if(n&1&&(a(0,"div",34)(1,"div",4)(2,"div",35),c(3,"img",40),a(4,"h5",7),i(5,"Agua"),l(),m(6,at,2,0,"p",41)(7,lt,2,0,"p",41)(8,it,2,0,"p",41),a(9,"p",37),i(10),l()()()()),n&2){let t=p(2);o(6),r("ngIf",t.data_sensor.data.Agua.Valor==0),o(),r("ngIf",t.data_sensor.data.Agua.Valor>0&&t.data_sensor.data.Agua.Valor<=50),o(),r("ngIf",t.data_sensor.data.Agua.Valor>50),o(2),_("Fecha: ",t.data_sensor.data.Agua.Fecha,"")}}function dt(n,d){n&1&&(a(0,"p",37),i(1,"Esta lloviendo"),l())}function st(n,d){n&1&&(a(0,"p"),i(1,"No esta lloviendo"),l())}function rt(n,d){if(n&1&&(a(0,"div",34)(1,"div",4)(2,"div",35),c(3,"img",42),a(4,"h5",7),i(5,"Lluvia"),l(),m(6,dt,2,0,"p",37)(7,st,2,0),a(8,"p",37),i(9),l()()()()),n&2){let t=p(2);o(6),g(6,t.data_sensor.data.Lluvia.Valor==0?6:7),o(3),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Lluvia==null?null:t.data_sensor.data.Lluvia.Fecha,"")}}function ut(n,d){n&1&&(a(0,"p",37),i(1,"Humedo"),l())}function mt(n,d){n&1&&(a(0,"p",37),i(1,"Falta humedad"),l())}function pt(n,d){if(n&1&&(a(0,"div",34)(1,"div",4)(2,"div",35),c(3,"img",43),a(4,"h5",7),i(5,"Suelo"),l(),m(6,ut,2,0,"p",37)(7,mt,2,0),a(8,"p",37),i(9),l()()()()),n&2){let t=p(2);o(6),g(6,t.data_sensor.data.Suelo.Valor>=50?6:7),o(3),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Suelo==null?null:t.data_sensor.data.Suelo.Fecha,"")}}function ct(n,d){n&1&&(a(0,"p",37),i(1,"Hay luz"),l())}function _t(n,d){n&1&&(a(0,"p",37),i(1,"Falta luz"),l())}function vt(n,d){if(n&1&&(a(0,"div",34)(1,"div",4)(2,"div",35),c(3,"img",44),a(4,"h5",7),i(5,"Luz"),l(),m(6,ct,2,0,"p",37)(7,_t,2,0),a(8,"p",37),i(9),l()()()()),n&2){let t=p(2);o(6),g(6,t.data_sensor.data.Luz.Valor>75?6:7),o(3),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Luz==null?null:t.data_sensor.data.Luz.Fecha,"")}}function ht(n,d){n&1&&(a(0,"p",37),i(1,"Hay movimiento"),l())}function gt(n,d){n&1&&(a(0,"p",37),i(1,"No hay movimiento"),l())}function ft(n,d){if(n&1&&(a(0,"div",4)(1,"div",35),c(2,"img",45),a(3,"h5",7),i(4,"Movimiento"),l(),m(5,ht,2,0,"p",37)(6,gt,2,0),a(7,"p",37),i(8),l()()()),n&2){let t=p(2);o(5),g(5,t.data_sensor.data.Movimiento.Valor==1?5:6),o(3),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Movimiento==null?null:t.data_sensor.data.Movimiento.Fecha,"")}}function St(n,d){n&1&&(a(0,"p",37),i(1,"Hay vibracion"),l())}function bt(n,d){n&1&&(a(0,"p",37),i(1,"No hay vibracion"),l())}function Pt(n,d){if(n&1&&(a(0,"div",34)(1,"div",4)(2,"div",35),c(3,"img",46),a(4,"h5",7),i(5,"Vibracion"),l(),m(6,St,2,0,"p",37)(7,bt,2,0),a(8,"p",37),i(9),l()()()()),n&2){let t=p(2);o(6),g(6,t.data_sensor.data.Vibracion.Valor==1?6:7),o(3),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Vibracion==null?null:t.data_sensor.data.Vibracion.Fecha,"")}}function xt(n,d){if(n&1&&(a(0,"div",1)(1,"div",32),m(2,ot,11,4,"div",33),a(3,"div",34)(4,"div",4)(5,"div",35),c(6,"img",36),a(7,"h5",7),i(8,"Temperatura"),l(),a(9,"p",37),i(10),l(),a(11,"p",37),i(12),l()()()(),a(13,"div",34)(14,"div",4)(15,"div",35),c(16,"img",38),a(17,"h5",7),i(18,"Humedad"),l(),a(19,"p",37),i(20),l(),a(21,"p",37),i(22),l()()()(),m(23,rt,10,2,"div",33)(24,pt,10,2,"div",33)(25,vt,10,2,"div",33),a(26,"div",34),m(27,ft,9,2,"div",39),l(),m(28,Pt,10,2,"div",33),l()()),n&2){let t=p();o(2),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Agua),o(8),w("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Unidad,""),o(2),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Temperatura==null?null:t.data_sensor.data.Temperatura.Fecha,""),o(8),w("Valor: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Valor," ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Unidad,""),o(2),_("Fecha: ",t.data_sensor==null||t.data_sensor.data==null||t.data_sensor.data.Humedad==null?null:t.data_sensor.data.Humedad.Fecha,""),o(),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Lluvia),o(),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Suelo),o(),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Luz),o(2),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Movimiento),o(),r("ngIf",t.data_sensor==null||t.data_sensor.data==null?null:t.data_sensor.data.Movimiento)}}function Ct(n,d){n&1&&(a(0,"div"),i(1,"Planta es requerida"),l())}function wt(n,d){if(n&1&&(a(0,"div",47),m(1,Ct,2,0,"div",48),l()),n&2){let t=p();o(),r("ngIf",t.putPlantForm.controls.plant==null||t.putPlantForm.controls.plant.errors==null?null:t.putPlantForm.controls.plant.errors.required)}}function It(n,d){n&1&&(a(0,"div"),i(1,"Status es requerido"),l())}function Et(n,d){if(n&1&&(a(0,"div",47),m(1,It,2,0,"div",48),l()),n&2){let t=p();o(),r("ngIf",t.putPlantForm.controls.status==null||t.putPlantForm.controls.status.errors==null?null:t.putPlantForm.controls.status.errors.required)}}var zt=(()=>{let d=class d{constructor(s,u,e,f){this.plantService=s,this.router=u,this.formBuilder=e,this.mongo=f,this.putPlant={plant:"",status:0},this.data_sensor={data:{_id:"",Temperatura:{Valor:0,Unidad:"",Fecha:""},Humedad:{Valor:0,Unidad:"",Fecha:""},Lluvia:{Valor:0,Unidad:"",Fecha:""},Suelo:{Valor:0,Unidad:"",Fecha:""},Agua:{Valor:0,Unidad:"",Fecha:""},Luz:{Valor:0,Unidad:"",Fecha:""},Movimiento:{Valor:0,Unidad:"",Fecha:""},Vibracion:{Valor:0,Unidad:"",Fecha:""},updated_at:"",created_at:""}},this.img="",this.msg="",this.buttonActive=!0,this.putPlantForm=this.formBuilder.group({plant:[this.putPlant.plant,[v.required,v.minLength(3),v.maxLength(50),v.pattern(/^[a-zA-Z0-9 ]+$/)]],status:[this.putPlant.status,[v.required,v.min(0),v.max(1)]]})}ngOnInit(){console.log(this.id),this.id&&(this.plantService.getPlantsById(this.id).subscribe(s=>{console.log("response",s),this.plantShow=s,console.log("var",this.plantShow)},s=>{console.log(s)}),this.mongo.MongoData().subscribe(s=>{console.log(s),this.data_sensor=s},s=>{console.log(s)}),this.websocket()),this.img=this.getImg()}getImg(){return`../../../assets/imagenes/plantsIcons/${Math.floor(Math.random()*5)+1}.jpg`}openModal(s){this.id=parseInt(s)}editModal(s,u,e){this.id=parseInt(s),this.putPlant.plant=u,this.putPlant.status=e}deletePlant(s){this.plantService.eliminarPlants(s).subscribe(u=>{this.ngOnInit(),console.log(u.msg),this.msg=u.msg,setTimeout(()=>{this.msg=""},3e3)})}editPlant(s){this.putPlant=this.putPlantForm.value,this.plantService.actualizarPlants(this.putPlant,s).subscribe(u=>{console.log(u.msg),this.msg=u.msg,setTimeout(()=>{this.msg=""},3e3),this.ngOnInit()})}regar(){this.mongo.BombEvent().subscribe(s=>{console.log(s),this.msg=s.msg,setTimeout(()=>{this.msg=""},3e3)}),this.buttonActive=!1,setTimeout(()=>{this.buttonActive=!0},15e3)}websocket(){window.Pusher=K.default,this.echo=new A({broadcaster:"pusher",key:"lifePlants09123",cluster:"mt1",encrypted:!0,wsHost:"18.227.105.11",wsPort:6001,disableStats:!0,forceTLS:!1}),this.echo.channel("dataSensors").listen(".MongoData",s=>{console.log("hola"),console.log(this.echo),console.log(s),this.data_sensor=s,console.log("PRUEBAAAA"),console.log(this.data_sensor)})}closewebsocket(){this.echo&&this.echo.disconnect()}ngOnDestroy(){this.closewebsocket()}};d.\u0275fac=function(u){return new(u||d)(S(N),S(M),S(Z),S(L))},d.\u0275cmp=E({type:d,selectors:[["app-plant"]],inputs:{id:"id"},standalone:!0,features:[F],decls:44,vars:26,consts:[["class","alert alert-success","role","alert",4,"ngIf"],[1,"container","mt-5"],[1,"d-flex","justify-content-center","align-items-center"],[1,"col-md-6"],[1,"card","border-primary","shadow"],[1,"card-body","text-center"],["alt","",1,"IconPlant","mx-auto","d-block",3,"src"],[1,"card-title","text-primary"],[3,"ngClass"],[1,"card-footer","text-center"],["type","button",1,"btn","add",3,"click","disabled"],["type","button","data-bs-toggle","modal","data-bs-target","#putPlant",1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-fill"],["class","btn btn-danger","type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",3,"click",4,"ngIf"],["class","btn btn-success","type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",3,"click",4,"ngIf"],["class","container mt-5",4,"ngIf"],[3,"modalId","modalTitle"],["type","button","data-bs-dismiss","modal",1,"btn",3,"click","ngClass"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","plant",1,"form-label"],["type","text","id","plant","formControlName","plant","name","plantPut","required","",1,"form-control"],["class","text-danger",4,"ngIf"],["for","status",1,"form-label"],["id","status","formControlName","status","name","status","required","",1,"form-control"],["value","1"],["value","0"],["type","submit","data-bs-dismiss","modal",1,"btn","add",3,"disabled"],["role","alert",1,"alert","alert-success"],["type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",1,"btn","btn-danger",3,"click"],["type","button","data-bs-toggle","modal","data-bs-target","#deletePlant",1,"btn","btn-success",3,"click"],[1,"row","justify-content-center"],["class","col-md-2 mb-4",4,"ngIf"],[1,"col-md-2","mb-4"],[1,"card-body","d-flex","flex-column","align-items-center"],["src","../../assets/imagenes/temp.png","alt","",1,"sensorIcon"],[1,"card-text"],["src","../../assets/imagenes/hum.png","alt","",1,"sensorIcon"],["class","card border-primary shadow",4,"ngIf"],["src","../../assets/imagenes/raindrops-310146_1280.png","alt","",1,"sensorIcon"],["class","card-text",4,"ngIf"],["src","../../assets/imagenes/lluvia.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/suelo.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/luz.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/mov.png","alt","",1,"sensorIcon"],["src","../../assets/imagenes/vibr.png","alt","",1,"sensorIcon"],[1,"text-danger"],[4,"ngIf"]],template:function(u,e){u&1&&(m(0,tt,2,1,"div",0),a(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),c(6,"img",6),a(7,"h1",7),i(8),l(),a(9,"h2",8),i(10),l()(),a(11,"div",9)(12,"button",10),h("click",function(){return e.regar()}),i(13,"Regar"),l(),a(14,"button",11),h("click",function(){return e.editModal(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.id,e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.plant,e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)}),c(15,"i",12),l(),m(16,et,2,0,"button",13)(17,nt,2,0,"button",14),l()()()()(),m(18,xt,29,12,"div",15),a(19,"app-modal",16)(20,"p"),i(21),l(),a(22,"button",17),h("click",function(){return e.deletePlant(e.id)}),i(23),l(),a(24,"button",18),i(25,"Cancelar"),l()(),a(26,"app-modal",16)(27,"form",19),h("ngSubmit",function(){return e.editPlant(e.id)}),a(28,"div",20)(29,"label",21),i(30,"Planta"),l(),c(31,"input",22),m(32,wt,2,1,"div",23),l(),a(33,"div",20)(34,"label",24),i(35,"Status"),l(),a(36,"select",25)(37,"option",26),i(38,"Activo"),l(),a(39,"option",27),i(40,"Inactivo"),l()(),m(41,Et,2,1,"div",23),l(),a(42,"button",28),i(43,"Editar"),l()()()),u&2&&(r("ngIf",e.msg),o(6),r("src",e.img,y),o(2),C(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.plant),o(),r("ngClass",I(20,X,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1)),o(),_(" ",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Activo":"Inactivo"," "),o(2),r("disabled",!e.buttonActive),o(4),r("ngIf",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1),o(),r("ngIf",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1),o(),r("ngIf",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1),o(),r("modalId","deletePlant")("modalTitle",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Desactivar planta":"Activar planta"),o(2),_("\xBFEst\xE1s seguro de ",(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"desactivar":"activar"," la planta?"),o(),r("ngClass",I(23,Y,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1,(e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)!=1)),o(),C((e.plantShow==null||e.plantShow.data==null?null:e.plantShow.data.status)==1?"Desactivar":"Activar"),o(3),r("modalId","putPlant")("modalTitle","Editar planta"),o(),r("formGroup",e.putPlantForm),o(5),r("ngIf",(e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.invalid)&&((e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.dirty)||(e.putPlantForm.controls.plant==null?null:e.putPlantForm.controls.plant.touched))),o(9),r("ngIf",(e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.invalid)&&((e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.dirty)||(e.putPlantForm.controls.status==null?null:e.putPlantForm.controls.status.touched))),o(),r("disabled",!e.putPlantForm.valid))},dependencies:[k,T,V,J,q,R,G,z,B,U,D,$,O,j,H],styles:[".add[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.sensorIcon[_ngcontent-%COMP%]{width:140px;height:100px}.IconPlant[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover}"]});let n=d;return n})();export{zt as PlantComponent};
